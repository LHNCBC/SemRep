<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->
<head>
<title>SICStus Prolog: MT Foreign Single</title>

<meta name="description" content="SICStus Prolog: MT Foreign Single">
<meta name="keywords" content="SICStus Prolog: MT Foreign Single">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Predicate-Index.html#Predicate-Index" rel="index" title="Predicate Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Foreign-Resources-and-Multiple-SICStus-Runtimes.html#Foreign-Resources-and-Multiple-SICStus-Runtimes" rel="up" title="Foreign Resources and Multiple SICStus Runtimes">
<link href="MT-Foreign-Multiple.html#MT-Foreign-Multiple" rel="next" title="MT Foreign Multiple">
<link href="Foreign-Resources-and-Multiple-SICStus-Runtimes.html#Foreign-Resources-and-Multiple-SICStus-Runtimes" rel="prev" title="Foreign Resources and Multiple SICStus Runtimes">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


<link href="texinfo.css" rel="stylesheet" type="text/css">
</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<a name="MT-Foreign-Single"></a>
<hr>
<a name="Foreign-Resources-Supporting-Only-One-SICStus-Runtime"></a>
<h4 class="subsection">8.3.1 Foreign Resources Supporting Only One SICStus Runtime</h4>

<p>A process will only contain one instance of the code and data of a
(dynamic) foreign resource even if the foreign resource is
loaded and used from more than one SICStus runtime.
</p>
<p>This presents a problem in the likely event that the foreign
resource maintains some state, e.g. global variables, between
invocations of functions in the foreign resource. The global state
will probably need to be separate between SICStus runtimes.  Requiring
a foreign resource to maintain its global state on a per SICStus
runtime basis would be an incompatible change. Instead, by default,
only the first SICStus runtime that loads a foreign resource will
be allowed to use it. If a subsequent SICStus runtime (in the same
process) tries to load the foreign resource, then an error will be
reported to the second SICStus runtime.
</p>
<p>When <code>splfr</code> builds a foreign resource, it will also
generate glue code. When the foreign resource is loaded, the
glue code will set up a global variable pointing to the dispatch
vector used in the foreign resource to access the SICStus
API. This is similar to how an embedding application accesses the
SICStus API.
</p>
<p>The glue code will also detect if a subsequent SICStus runtime in
the same process tries to initialize the foreign resource. In this
case, an error will be reported.
</p>
<p>This means that pre 3.9 foreign code should only need to be rebuilt with
<code>splfr</code> to work with the latest version of SICStus. However, a
recommended change is that all C files of a foreign resource
include the header file generated by <code>splfr</code>. Inclusion of this
generated header file may become mandatory in a future release.
See <a href="The-Foreign-Resource-Linker.html#The-Foreign-Resource-Linker">The Foreign Resource Linker</a>.
</p>
<hr>



<div class="logo">
<a href="http://sicstus.sics.se/">
<table><tr><td>&nbsp;</td></tr></table>
</a>
</div>
<div class="node">
<ul class="node">
<li><a href="index.html#Top">User's Manual</a>
<hr>
<li><a href="index.html#TOC">Table of Contents</a>
<li><a href="MT-Foreign-Multiple.html#MT-Foreign-Multiple" accesskey="n" rel="next">Next</a>
<li><a href="Foreign-Resources-and-Multiple-SICStus-Runtimes.html#Foreign-Resources-and-Multiple-SICStus-Runtimes" accesskey="u" rel="up">Up</a>
</ul>
</div>
<hr>
<a HREF="mailto:sicstus-support@sics.se?subject=Documentation%20feedback%20on%20html/sicstus/MT-Foreign-Single.html&amp;body=Feedback%20on%20documentation%20node%20html/sicstus/MT-Foreign-Single.html%20in%20User's%20Manual.">Send feedback on this subject.</a>
</body>
</html>
